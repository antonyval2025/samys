<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Suite - Sistema de Gesti√≥n de Turnos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .test-item {
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #ddd;
        }
        .test-item.pass {
            background: #d4edda;
            border-left-color: #28a745;
            color: #155724;
        }
        .test-item.fail {
            background: #f8d7da;
            border-left-color: #dc3545;
            color: #721c24;
        }
        .test-item.warning {
            background: #fff3cd;
            border-left-color: #ffc107;
            color: #856404;
        }
        .code {
            background: #f4f4f4;
            padding: 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .summary {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            text-align: left;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f0e4d9;
            color: #6b5b7d;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Test Suite - Sistema de Gesti√≥n de Turnos</h1>
        
        <div class="test-section">
            <h2>1Ô∏è‚É£ Validaci√≥n de Carga de Scripts</h2>
            <div id="test-scripts"></div>
        </div>

        <div class="test-section">
            <h2>2Ô∏è‚É£ Validaci√≥n de Estructura HTML</h2>
            <div id="test-html"></div>
        </div>

        <div class="test-section">
            <h2>3Ô∏è‚É£ Validaci√≥n de Datos Iniciales</h2>
            <div id="test-data"></div>
        </div>

        <div class="test-section">
            <h2>4Ô∏è‚É£ Validaci√≥n de Funciones Principales</h2>
            <div id="test-functions"></div>
        </div>

        <div class="test-section">
            <h2>5Ô∏è‚É£ Validaci√≥n de Colores Pastel</h2>
            <div id="test-colors"></div>
        </div>

        <div class="test-section">
            <h2>üìä Resumen de Resultados</h2>
            <div id="test-summary" class="summary"></div>
        </div>
    </div>

    <script>
        let totalTests = 0;
        let passTests = 0;
        let failTests = 0;
        let warningTests = 0;

        function addTest(sectionId, name, passed, message = '') {
            totalTests++;
            const section = document.getElementById(sectionId);
            const div = document.createElement('div');
            const status = passed ? 'pass' : 'fail';
            
            if (passed) passTests++;
            else failTests++;
            
            div.className = `test-item ${status}`;
            div.innerHTML = `<strong>${passed ? '‚úì' : '‚úó'} ${name}</strong>${message ? ': ' + message : ''}`;
            section.appendChild(div);
        }

        function addWarning(sectionId, name, message = '') {
            totalTests++;
            warningTests++;
            const section = document.getElementById(sectionId);
            const div = document.createElement('div');
            div.className = `test-item warning`;
            div.innerHTML = `<strong>‚ö† ${name}</strong>${message ? ': ' + message : ''}`;
            section.appendChild(div);
        }

        // Test 1: Validaci√≥n de scripts
        console.log('üîç Iniciando tests...');

        // Verificar que el archivo principal est√° en el DOM
        const scripts = Array.from(document.scripts).map(s => s.src);
        addTest('test-scripts', 'HTML cargado en el navegador', true, `${scripts.length} scripts encontrados`);

        // Verificar CSS
        const links = Array.from(document.styleSheets).map(s => s.href || 'inline');
        const hasCSSPastel = document.body.style.background.includes('f0e4d9') || 
                             window.getComputedStyle(document.body).background.includes('f0e4d9');
        addTest('test-colors', 'CSS pastel cargado', hasCSSPastel, hasCSSPastel ? 'Fondo pastel detectado' : 'Verificar CSS');

        // Test 2: Validaci√≥n de HTML
        const headerExists = !!document.querySelector('header');
        addTest('test-html', 'Header existe', headerExists);

        const topControlsExists = !!document.querySelector('.top-controls');
        addTest('test-html', 'Top controls existe', topControlsExists);

        const tabsExist = document.querySelectorAll('.tab-btn').length >= 2;
        addTest('test-html', 'Tabs existen', tabsExist, `${document.querySelectorAll('.tab-btn').length} tabs encontradas`);

        const cuadranteGeneralExists = !!document.getElementById('tab-general');
        addTest('test-html', 'Tab Cuadrante General existe', cuadranteGeneralExists);

        const cuadranteIndividualExists = !!document.getElementById('tab-individual');
        addTest('test-html', 'Tab Informe Individual existe', cuadranteIndividualExists);

        const modalGestionEmpleadosExists = !!document.getElementById('modalGestionEmpleados');
        addTest('test-html', 'Modal Gesti√≥n Empleados existe', modalGestionEmpleadosExists);

        // Test 3: Validaci√≥n de datos
        const empleadosExists = typeof empleados !== 'undefined';
        addTest('test-data', 'Variable "empleados" existe', empleadosExists);

        if (empleadosExists) {
            addTest('test-data', 'Empleados cargados', Array.isArray(empleados), `${empleados.length} empleados en array`);
            
            if (empleados.length > 0) {
                const firstEmpleado = empleados[0];
                const hasRequiredFields = firstEmpleado.id && firstEmpleado.nombre && firstEmpleado.departamento;
                addTest('test-data', 'Empleados tienen campos requeridos', hasRequiredFields, 
                    `ID: ${firstEmpleado.id}, Nombre: ${firstEmpleado.nombre}`);
            }
        }

        const appStateExists = typeof AppState !== 'undefined';
        addTest('test-data', 'AppState existe', appStateExists);

        if (appStateExists) {
            addTest('test-data', 'AppState.currentYear definido', AppState.currentYear > 2020, `A√±o: ${AppState.currentYear}`);
            addTest('test-data', 'AppState.currentMonth definido', AppState.currentMonth >= 0 && AppState.currentMonth <= 11, `Mes: ${AppState.currentMonth}`);
            addTest('test-data', 'AppState.scheduleData es Map', AppState.scheduleData instanceof Map);
        }

        // Test 4: Validaci√≥n de funciones principales
        const functionsToCheck = [
            { name: 'EmployeeManager', method: 'abrirModal' },
            { name: 'TurnoManager', method: 'reiniciarDatos' },
            { name: 'TurnoEditor', method: 'mostrarModalEdicionMasiva' },
            { name: 'ExportManager', method: 'exportarCuadranteGeneral' },
            { name: 'DateUtils', method: 'cambiarMes' }
        ];

        functionsToCheck.forEach(func => {
            const exists = typeof window[func.name] !== 'undefined';
            addTest('test-functions', `${func.name} existe`, exists);
            
            if (exists) {
                const methodExists = typeof window[func.name][func.method] === 'function';
                addTest('test-functions', `${func.name}.${func.method}() es funci√≥n`, methodExists);
            }
        });

        // Test 5: Validaci√≥n de botones onclick
        const buttonElements = [
            { selector: 'button[onclick*="EmployeeManager.abrirModal"]', name: 'üë• Empleados' },
            { selector: 'button[onclick*="TurnoManager.reiniciarDatos"]', name: 'üìã Generar' },
            { selector: 'button[onclick*="tab-individual"]', name: 'üìä Informe' }
        ];

        buttonElements.forEach(btn => {
            const exists = !!document.querySelector(btn.selector);
            addTest('test-html', `Bot√≥n "${btn.name}" tiene onclick`, exists);
        });

        // Test 6: Validaci√≥n de colores pastel
        const pastelColors = {
            '#d4c5e2': 'Lavanda',
            '#c9b3d9': 'Lavanda oscuro',
            '#e2d4c5': 'Beige pastel',
            '#f3d4d9': 'Rosa pastel',
            '#c5e2c9': 'Verde pastel'
        };

        const buttons = document.querySelectorAll('[style*="background"]');
        const coloresDetectados = new Set();
        buttons.forEach(btn => {
            const bg = window.getComputedStyle(btn).backgroundColor;
            Object.keys(pastelColors).forEach(color => {
                if (btn.style.background && btn.style.background.includes(color.substring(1))) {
                    coloresDetectados.add(color);
                }
            });
        });

        addTest('test-colors', 'Colores pastel aplicados en botones', coloresDetectados.size > 0, 
            `${coloresDetectados.size} colores pastel detectados`);

        // Resumen final
        const summary = document.getElementById('test-summary');
        const successRate = ((passTests / totalTests) * 100).toFixed(1);
        summary.innerHTML = `
            <h3>üìà Resultados Finales</h3>
            <table>
                <tr>
                    <th>M√©trica</th>
                    <th>Cantidad</th>
                    <th>Porcentaje</th>
                </tr>
                <tr style="background: #d4edda;">
                    <td>‚úì Tests Pasados</td>
                    <td><strong>${passTests}</strong></td>
                    <td>${((passTests / totalTests) * 100).toFixed(1)}%</td>
                </tr>
                <tr style="background: #f8d7da;">
                    <td>‚úó Tests Fallidos</td>
                    <td><strong>${failTests}</strong></td>
                    <td>${((failTests / totalTests) * 100).toFixed(1)}%</td>
                </tr>
                <tr style="background: #fff3cd;">
                    <td>‚ö† Advertencias</td>
                    <td><strong>${warningTests}</strong></td>
                    <td>${((warningTests / totalTests) * 100).toFixed(1)}%</td>
                </tr>
                <tr style="background: #e7f3ff; font-weight: bold;">
                    <td>Total Tests</td>
                    <td><strong>${totalTests}</strong></td>
                    <td>${successRate}%</td>
                </tr>
            </table>
            <p style="margin-top: 15px;"><strong>Estado General:</strong> ${successRate >= 80 ? '‚úì ACEPTABLE' : failTests > 0 ? '‚úó NECESITA FIXES' : '‚úì EXCELENTE'}</p>
            ${failTests > 0 ? '<p style="color: #721c24;"><strong>Acciones requeridas:</strong> Ver tests fallidos arriba para detalles.</p>' : ''}
        `;

        console.log(`‚úÖ Tests completados: ${passTests} pasados, ${failTests} fallidos, ${warningTests} advertencias`);
    </script>
</body>
</html>
