<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Opciones Editor Turnos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .output { background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; white-space: pre-wrap; max-height: 400px; overflow-y: auto; border: 1px solid #dee2e6; }
        button { padding: 12px 24px; background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 5px; }
        button:hover { background: linear-gradient(135deg, #0056b3 0%, #004085 100%); }
        .section { margin: 20px 0; padding: 15px; border-left: 4px solid #007bff; background: #f8f9fa; }
        h1 { color: #333; text-align: center; }
        h2 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Test Opciones Editor de Turnos</h1>
        <p>Este test verifica qu√© opciones se muestran en el editor de turnos.</p>

        <div class="section">
            <button onclick="testOpcionesEditor()">üîç Test Opciones Editor</button>
            <button onclick="testTiposTurno()">üìã Ver Tipos de Turno</button>
            <button onclick="abrirAplicacion()">üì± Abrir Aplicaci√≥n</button>
        </div>

        <h2>Resultado del Test:</h2>
        <div class="output" id="output">Haz clic en "Test Opciones Editor" para comenzar...</div>
    </div>

    <script src="js/modules.js"></script>
    <script>
        // Inicializar empleados con la lista completa
        window.empleados = [
            { id: 1, nombre: "Empleado 1", localidad: "Madrid", horasContrato: 160 },
            { id: 2, nombre: "Empleado 2", localidad: "Madrid", horasContrato: 160 },
            { id: 3, nombre: "Empleado 3", localidad: "Madrid", horasContrato: 160 },
            { id: 4, nombre: "Empleado 4", localidad: "Madrid", horasContrato: 160 },
            { id: 5, nombre: "Empleado 5", localidad: "Madrid", horasContrato: 160 },
            { id: 6, nombre: "Empleado 6", localidad: "Madrid", horasContrato: 160 },
            { id: 7, nombre: "Empleado 7", localidad: "Madrid", horasContrato: 160 },
            { id: 8, nombre: "antony valencia", localidad: "Madrid", horasContrato: 154 }
        ];

        // Inicializar AppState
        AppState.currentYear = new Date().getFullYear();
        AppState.currentMonth = new Date().getMonth();

        function log(message) {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            output.textContent += `[${timestamp}] ${message}\n`;
            console.log(message);
        }

        function testOpcionesEditor() {
            document.getElementById('output').textContent = '';
            log('üß™ === TEST OPCIONES EDITOR ===');

            try {
                // Simular c√≥mo se generan las opciones en abrirEditorTurno
                const turnos = Object.keys(tiposTurno);
                log(`üìä Total tipos de turno disponibles: ${turnos.length}`);
                log('');

                log('üéØ OPCIONES DISPONIBLES EN EL EDITOR:');
                turnos.forEach((t, index) => {
                    const inicial = tiposTurno[t].inicial;
                    const nombre = tiposTurno[t].nombre;
                    log(`  ${index + 1}. Valor: "${t}" ‚Üí ${inicial} - ${nombre}`);
                });

                log('');
                log('üîç BUSCANDO "asuntospropios":');
                const asuntosPropios = turnos.find(t => t === 'asuntospropios');
                if (asuntosPropios) {
                    log(`‚úÖ "asuntospropios" encontrado: ${tiposTurno[asuntosPropios].nombre}`);
                } else {
                    log('‚ùå "asuntospropios" NO encontrado');
                }

                log('');
                log('üîç BUSCANDO "asuntos_propios":');
                const asuntos_propios = turnos.find(t => t === 'asuntos_propios');
                if (asuntos_propios) {
                    log(`‚úÖ "asuntos_propios" encontrado: ${tiposTurno[asuntos_propios].nombre}`);
                } else {
                    log('‚ùå "asuntos_propios" NO encontrado (este es el problema)');
                }

                log('');
                log('üí° CONCLUSI√ìN:');
                if (asuntosPropios && !asuntos_propios) {
                    log('‚úÖ El sistema funciona correctamente con "asuntospropios"');
                    log('‚ùå El usuario debe usar "asuntospropios" (sin gui√≥n bajo)');
                } else if (!asuntosPropios && asuntos_propios) {
                    log('‚ùå El sistema tiene "asuntos_propios" (con gui√≥n)');
                    log('üîß Necesita corregirse a "asuntospropios"');
                } else {
                    log('‚ùì Configuraci√≥n inesperada de tipos de turno');
                }

            } catch (error) {
                log(`‚ùå Error en test: ${error.message}`);
            }

            log('');
            log('üèÅ === TEST COMPLETADO ===');
        }

        function testTiposTurno() {
            document.getElementById('output').textContent = '';
            log('üìã === TIPOS DE TURNO DISPONIBLES ===');

            try {
                log(`üìä Total tipos definidos: ${Object.keys(tiposTurno).length}`);
                log('');

                Object.entries(tiposTurno).forEach(([key, value], index) => {
                    log(`${index + 1}. ${key}:`);
                    log(`   - Nombre: ${value.nombre}`);
                    log(`   - Inicial: ${value.inicial}`);
                    log(`   - Horas: ${value.horas}`);
                    log(`   - Color: ${value.color}`);
                    log('');
                });

            } catch (error) {
                log(`‚ùå Error: ${error.message}`);
            }
        }

        function abrirAplicacion() {
            window.open('nuevo_cuadrante_mejorado.html', '_blank');
        }

        // Auto-ejecutar test b√°sico al cargar
        setTimeout(() => {
            if (document.getElementById('output').textContent.includes('Haz clic')) {
                testOpcionesEditor();
            }
        }, 500);
    </script>
</body>
</html>