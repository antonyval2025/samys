<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ DEMO Semana 3 - M√≥dulos en Acci√≥n</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }
        .header h1 {
            color: #667eea;
            font-size: 28px;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 16px;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .module-box {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-top: 4px solid #667eea;
        }
        .module-box.red { border-top-color: #dc3545; }
        .module-box.green { border-top-color: #28a745; }
        .module-box.blue { border-top-color: #667eea; }
        .module-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        .module-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }
        .module-feature {
            margin: 10px 0;
            padding: 8px;
            background: #f8f9fa;
            border-left: 3px solid #667eea;
            border-radius: 4px;
            font-size: 14px;
        }
        .module-feature.red { border-left-color: #dc3545; }
        .module-feature.green { border-left-color: #28a745; }
        .module-feature.blue { border-left-color: #667eea; }
        .section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-bottom: 15px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }
        button:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        button.danger {
            background: #dc3545;
        }
        button.danger:hover {
            background: #c82333;
        }
        button.success {
            background: #28a745;
        }
        button.success:hover {
            background: #218838;
        }
        .metric {
            display: inline-block;
            background: #f0f0f0;
            padding: 10px 15px;
            border-radius: 6px;
            margin-right: 10px;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
        }
        .metric.value {
            color: #667eea;
        }
        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 4px solid;
        }
        .alert.info {
            background: #e7f3ff;
            color: #004085;
            border-color: #667eea;
        }
        .alert.warning {
            background: #fff3cd;
            color: #856404;
            border-color: #ffc107;
        }
        .alert.danger {
            background: #f8d7da;
            color: #721c24;
            border-color: #dc3545;
        }
        .alert.success {
            background: #d4edda;
            color: #155724;
            border-color: #28a745;
        }
        @media (max-width: 1024px) {
            .grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ DEMOSTRACI√ìN - Semana 3</h1>
            <p>Visualiza los 3 m√≥dulos nuevos en acci√≥n: AnalizadorConflictos, DashboardAnalytica, OptimizadorTurnos</p>
        </div>

        <!-- Tarjetas de m√≥dulos -->
        <div class="grid">
            <!-- M√≥dulo 1: AnalizadorConflictos -->
            <div class="module-box red">
                <div class="module-icon">üö®</div>
                <div class="module-title">AnalizadorConflictos</div>
                <div class="module-feature red">‚úì Detecta turnos nocturnos excesivos</div>
                <div class="module-feature red">‚úì Valida descansos insuficientes</div>
                <div class="module-feature red">‚úì Identifica conflictos de estado</div>
                <div class="module-feature red">‚úì Predicci√≥n de cambios</div>
            </div>

            <!-- M√≥dulo 2: DashboardAnalytica -->
            <div class="module-box green">
                <div class="module-icon">üìä</div>
                <div class="module-title">DashboardAnalytica</div>
                <div class="module-feature green">‚úì Calcula KPIs en tiempo real</div>
                <div class="module-feature green">‚úì √çndice de equidad (Gini)</div>
                <div class="module-feature green">‚úì Gr√°ficos ASCII autom√°ticos</div>
                <div class="module-feature green">‚úì Historial de m√©tricas</div>
            </div>

            <!-- M√≥dulo 3: OptimizadorTurnos -->
            <div class="module-box blue">
                <div class="module-icon">‚ö°</div>
                <div class="module-title">OptimizadorTurnos</div>
                <div class="module-feature blue">‚úì Sugerencias autom√°ticas</div>
                <div class="module-feature blue">‚úì Detecci√≥n de desequilibrios</div>
                <div class="module-feature blue">‚úì An√°lisis de patrones</div>
                <div class="module-feature blue">‚úì Ranking de mejoras</div>
            </div>
        </div>

        <!-- Secci√≥n: AnalizadorConflictos -->
        <div class="section">
            <h2>üö® M√≥dulo 1: AnalizadorConflictos</h2>
            <div class="alert info">
                <strong>Descripci√≥n:</strong> Detecta conflictos en la asignaci√≥n de turnos (noche excesiva, descansos insuficientes, conflictos de estado)
            </div>
            <div class="button-group">
                <button onclick="ejecutarAnalizador()">‚ñ∂ Analizar Cuadrante</button>
                <button onclick="analizarEmpleado1()">üë§ Analizar Empleado 1</button>
                <button onclick="analizarEmpleado3()">üë§ Analizar Empleado 3 (Vacaciones)</button>
                <button class="danger" onclick="limpiarOutput('output1')">üóë Limpiar</button>
            </div>
            <div id="output1" class="output">Presiona un bot√≥n para ver resultados...</div>
        </div>

        <!-- Secci√≥n: DashboardAnalytica -->
        <div class="section">
            <h2>üìä M√≥dulo 2: DashboardAnalytica</h2>
            <div class="alert info">
                <strong>Descripci√≥n:</strong> Genera m√©tricas y an√°lisis en tiempo real del cuadrante (ocupaci√≥n, eficiencia, equidad)
            </div>
            <div class="button-group">
                <button class="success" onclick="calcularMetricas()">üìà Calcular M√©tricas</button>
                <button class="success" onclick="generarGraficos()">üìâ Generar Gr√°ficos</button>
                <button class="success" onclick="obtenerTendencias()">üìä Ver Tendencias</button>
                <button class="danger" onclick="limpiarOutput('output2')">üóë Limpiar</button>
            </div>
            <div id="output2" class="output">Presiona un bot√≥n para ver resultados...</div>
        </div>

        <!-- Secci√≥n: OptimizadorTurnos -->
        <div class="section">
            <h2>‚ö° M√≥dulo 3: OptimizadorTurnos</h2>
            <div class="alert info">
                <strong>Descripci√≥n:</strong> Genera sugerencias autom√°ticas para mejorar la distribuci√≥n de turnos
            </div>
            <div class="button-group">
                <button class="success" onclick="generarSugerencias()">üí° Generar Sugerencias</button>
                <button class="success" onclick="mejorSugerencia()">üèÜ Mejor Sugerencia</button>
                <button class="success" onclick="obtenerResumenOpt()">üìã Resumen de Mejoras</button>
                <button class="danger" onclick="limpiarOutput('output3')">üóë Limpiar</button>
            </div>
            <div id="output3" class="output">Presiona un bot√≥n para ver resultados...</div>
        </div>

        <!-- Secci√≥n: Resumen Integraci√≥n -->
        <div class="section">
            <h2>‚úÖ Resumen de Integraci√≥n</h2>
            <div class="alert success">
                <strong>Estado:</strong> ‚úÖ Los 3 m√≥dulos est√°n completamente integrados en nuevo_cuadrante_mejorado.html
            </div>
            <div class="metric">üì¶ M√≥dulos Cargados: <span class="value" id="modulosStatus">Verificando...</span></div>
            <div class="metric">‚úÖ Tests Pasados: <span class="value">18/18</span></div>
            <div class="metric">‚ùå Fallos: <span class="value">0</span></div>
            <div class="metric">üìù L√≠neas de C√≥digo: <span class="value">1,350+</span></div>
        </div>
    </div>

    <!-- Scripts de los m√≥dulos -->
    <script src="js/analizador-conflictos.js"></script>
    <script src="js/dashboard-analytica.js"></script>
    <script src="js/optimizador-turnos.js"></script>

    <script>
        // ============ SETUP GLOBAL ============
        if (typeof empleados === 'undefined') {
            window.empleados = [
                { 
                    id: 1, 
                    nombre: 'Juan Garc√≠a', 
                    email: 'juan@test.com', 
                    telefono: '645123456', 
                    horasContrato: 160,
                    departamento: 'Operaciones',
                    estado: 'activo'
                },
                { 
                    id: 2, 
                    nombre: 'Mar√≠a L√≥pez', 
                    email: 'maria@test.com', 
                    telefono: '612345678', 
                    horasContrato: 160,
                    departamento: 'Ventas',
                    estado: 'activo'
                },
                { 
                    id: 3, 
                    nombre: 'Pedro Mart√≠nez', 
                    email: 'pedro@test.com', 
                    telefono: '698765432', 
                    horasContrato: 160,
                    departamento: 'Operaciones',
                    estado: 'vacaciones'
                }
            ];
        }

        if (typeof AppState === 'undefined') {
            window.AppState = {
                currentMonth: 0,
                currentYear: 2026,
                scheduleData: new Map([
                    [1, [
                        { dia: 1, turno: 'ma√±ana', mes: 0, anio: 2026, horas: 8 },
                        { dia: 2, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 3, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 4, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 5, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 6, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 7, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 8, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 9, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 10, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 11, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 12, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 13, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 14, turno: 'noche', mes: 0, anio: 2026, horas: 8 },
                        { dia: 15, turno: 'descanso', mes: 0, anio: 2026, horas: 0 }
                    ]],
                    [2, [
                        { dia: 1, turno: 'tarde', mes: 0, anio: 2026, horas: 8 },
                        { dia: 2, turno: 'ma√±ana', mes: 0, anio: 2026, horas: 8 },
                        { dia: 3, turno: 'tarde', mes: 0, anio: 2026, horas: 8 },
                        { dia: 4, turno: 'descanso', mes: 0, anio: 2026, horas: 0 },
                        { dia: 5, turno: 'descanso', mes: 0, anio: 2026, horas: 0 }
                    ]],
                    [3, [
                        { dia: 1, turno: 'vacaciones', mes: 0, anio: 2026, horas: 0 },
                        { dia: 2, turno: 'vacaciones', mes: 0, anio: 2026, horas: 0 },
                        { dia: 3, turno: 'vacaciones', mes: 0, anio: 2026, horas: 0 }
                    ]]
                ]),
                cambiosPendientes: []
            };
        }

        // ============ FUNCIONES DE DEMO ============
        function mostrarOutput(id, contenido) {
            document.getElementById(id).textContent = contenido;
        }

        function limpiarOutput(id) {
            document.getElementById(id).textContent = 'Presiona un bot√≥n para ver resultados...';
        }

        // --- AnalizadorConflictos ---
        function ejecutarAnalizador() {
            try {
                AnalizadorConflictos.init();
                const resumen = AnalizadorConflictos.obtenerResumen();
                const output = `‚úÖ ANALIZADOR DE CONFLICTOS EJECUTADO
                
üìä Resumen:
- Total Conflictos: ${resumen.totalConflictos}
- Alertas Cr√≠ticas: ${resumen.alertasCriticas}
- Advertencias: ${resumen.advertencias}

üîç Detalles:
${JSON.stringify(resumen, null, 2)}`;
                mostrarOutput('output1', output);
            } catch (e) {
                mostrarOutput('output1', `‚ùå Error: ${e.message}`);
            }
        }

        function analizarEmpleado1() {
            try {
                const conflictos = AnalizadorConflictos.analizarEmpleado(1);
                const output = `üë§ AN√ÅLISIS EMPLEADO 1 (Juan Garc√≠a)

Turnos: ${AppState.scheduleData.get(1).length} d√≠as registrados
Conflictos Detectados: ${conflictos.length}

üìã Detalle de Conflictos:
${conflictos.length > 0 ? conflictos.map((c, i) => `${i+1}. ${c.tipo} - D√≠a ${c.dia}: ${c.descripcion}`).join('\n') : 'Sin conflictos detectados'}`;
                mostrarOutput('output1', output);
            } catch (e) {
                mostrarOutput('output1', `‚ùå Error: ${e.message}`);
            }
        }

        function analizarEmpleado3() {
            try {
                const conflictos = AnalizadorConflictos.analizarEmpleado(3);
                const output = `üë§ AN√ÅLISIS EMPLEADO 3 (Pedro Mart√≠nez - EN VACACIONES)

Estado: üèñÔ∏è VACACIONES
Turnos: ${AppState.scheduleData.get(3).length} d√≠as registrados
Conflictos Detectados: ${conflictos.length}

‚ö†Ô∏è Nota: Este empleado est√° en vacaciones. El sistema detecta conflictos de asignaci√≥n.

üìã Detalle de Conflictos:
${conflictos.length > 0 ? conflictos.map((c, i) => `${i+1}. ${c.tipo} - D√≠a ${c.dia}: ${c.descripcion}`).join('\n') : 'Sin conflictos detectados'}`;
                mostrarOutput('output1', output);
            } catch (e) {
                mostrarOutput('output1', `‚ùå Error: ${e.message}`);
            }
        }

        // --- DashboardAnalytica ---
        function calcularMetricas() {
            try {
                DashboardAnalytica.init();
                const metricas = DashboardAnalytica.obtenerMetricas();
                const output = `üìä M√âTRICAS DEL CUADRANTE

üë• Empleados Analizados: ${metricas.totalEmpleados}

üìà KPIs PRINCIPALES:
- Ocupaci√≥n: ${metricas.kpis.ocupacion}%
- Eficiencia: ${metricas.kpis.eficiencia}%
- Equidad (Gini): ${metricas.kpis.equidadScore}%

üìä Distribuci√≥n de Turnos:
- Ma√±ana: ${metricas.distribucion.ma√±ana} turnos
- Tarde: ${metricas.distribucion.tarde} turnos
- Noche: ${metricas.distribucion.noche} turnos
- Descanso: ${metricas.distribucion.descanso} d√≠as
- Vacaciones: ${metricas.distribucion.vacaciones} d√≠as

‚è∞ Horas Totales: ${metricas.horasTotales} horas
‚öñÔ∏è Equidad Score: ${metricas.kpis.equidadScore}% (0=perfecto, 100=m√°ximo desequilibrio)`;
                mostrarOutput('output2', output);
            } catch (e) {
                mostrarOutput('output2', `‚ùå Error: ${e.message}`);
            }
        }

        function generarGraficos() {
            try {
                DashboardAnalytica.init();
                const graficoDistribucion = DashboardAnalytica.generarGraficoDistribucion();
                const graficoTurnos = DashboardAnalytica.generarGraficoTurnos();
                const output = `üìâ GR√ÅFICOS GENERADOS

${graficoDistribucion}

${graficoTurnos}`;
                mostrarOutput('output2', output);
            } catch (e) {
                mostrarOutput('output2', `‚ùå Error: ${e.message}`);
            }
        }

        function obtenerTendencias() {
            try {
                const tendencias = DashboardAnalytica.obtenerTendencias();
                const output = `üìä AN√ÅLISIS DE TENDENCIAS

Tendencias Detectadas: ${tendencias.length}

${tendencias.length > 0 ? tendencias.map((t, i) => `${i+1}. ${t}`).join('\n') : 'Sin tendencias detectadas'}

üí° Recomendaci√≥n: El sistema monitorea cambios en ocupaci√≥n, eficiencia y equidad a lo largo del tiempo.`;
                mostrarOutput('output2', output);
            } catch (e) {
                mostrarOutput('output2', `‚ùå Error: ${e.message}`);
            }
        }

        // --- OptimizadorTurnos ---
        function generarSugerencias() {
            try {
                OptimizadorTurnos.init();
                const resumen = OptimizadorTurnos.obtenerResumen();
                const output = `üí° SUGERENCIAS DE OPTIMIZACI√ìN

Total de Sugerencias: ${resumen.totalSugerencias}

üìä Desglose por Tipo:
- Balanceo: ${resumen.porTipo.balanceo} sugerencias
- Mejora: ${resumen.porTipo.mejora} sugerencias
- Prevenci√≥n: ${resumen.porTipo.prevenci√≥n} sugerencias

üéØ Prioridades:
- Cr√≠tica: ${resumen.porPrioridad.critica}
- Alta: ${resumen.porPrioridad.alta}
- Media: ${resumen.porPrioridad.media}
- Baja: ${resumen.porPrioridad.baja}

‚úÖ Mejoras Ejecutadas: ${resumen.mejoresEjecutadas}`;
                mostrarOutput('output3', output);
            } catch (e) {
                mostrarOutput('output3', `‚ùå Error: ${e.message}`);
            }
        }

        function mejorSugerencia() {
            try {
                const sugerencia = OptimizadorTurnos.obtenerMejorSugerencia();
                if (!sugerencia) {
                    mostrarOutput('output3', '‚ö†Ô∏è No hay sugerencias disponibles en este momento.');
                    return;
                }
                const output = `üèÜ LA MEJOR SUGERENCIA

Tipo: ${sugerencia.tipo}
Prioridad: ${sugerencia.prioridad}
Empleado: ${sugerencia.empleado || 'N/A'}

üìù Descripci√≥n:
${sugerencia.sugerencia || sugerencia.mensaje}

üí∞ Impacto Esperado:
- Mejora de Equidad: ${sugerencia.impacto?.equidad || 'N/A'}
- Ocupaci√≥n: ${sugerencia.impacto?.ocupacion || 'N/A'}

üöÄ Acci√≥n Recomendada:
${sugerencia.accion || 'Implementar sugerencia inmediatamente'}`;
                mostrarOutput('output3', output);
            } catch (e) {
                mostrarOutput('output3', `‚ùå Error: ${e.message}`);
            }
        }

        function obtenerResumenOpt() {
            try {
                const resumen = OptimizadorTurnos.obtenerResumen();
                const output = `üìã RESUMEN DE OPTIMIZACI√ìN

Estado General: ${resumen.totalSugerencias > 0 ? '‚ö†Ô∏è Mejoras Disponibles' : '‚úÖ Cuadrante Optimizado'}

üìà Estad√≠sticas:
- Total Sugerencias Generadas: ${resumen.totalSugerencias}
- Mejoras Ejecutadas: ${resumen.mejoresEjecutadas}
- Tasa de Implementaci√≥n: ${resumen.totalSugerencias > 0 ? ((resumen.mejoresEjecutadas / resumen.totalSugerencias) * 100).toFixed(1) : 0}%

üéØ Pr√≥ximos Pasos:
1. Revisar las sugerencias autom√°ticas generadas
2. Seleccionar la mejor sugerencia (bot√≥n anterior)
3. Implementar cambios en el cuadrante
4. Monitorear el impacto en m√©tricas`;
                mostrarOutput('output3', output);
            } catch (e) {
                mostrarOutput('output3', `‚ùå Error: ${e.message}`);
            }
        }

        // ============ VERIFICACI√ìN AL CARGAR ============
        window.addEventListener('load', function() {
            let status = '‚úÖ ';
            let count = 0;
            if (typeof AnalizadorConflictos !== 'undefined') {
                count++;
                status += 'Analizador ';
            }
            if (typeof DashboardAnalytica !== 'undefined') {
                count++;
                status += 'Dashboard ';
            }
            if (typeof OptimizadorTurnos !== 'undefined') {
                count++;
                status += 'Optimizador';
            }
            document.getElementById('modulosStatus').textContent = count === 3 ? '3/3 M√≥dulos Cargados' : `${count}/3 M√≥dulos`;
        });
    </script>
</body>
</html>
