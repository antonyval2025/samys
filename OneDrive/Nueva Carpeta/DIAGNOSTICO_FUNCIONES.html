<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>üîç DIAGN√ìSTICO - Funciones TurnoManager</title>
    <style>
        body { font-family: monospace; background: #0f172a; color: #f1f5f9; padding: 20px; }
        pre { background: #1e293b; padding: 15px; border-radius: 8px; overflow-x: auto; border-left: 4px solid #10b981; }
        .pass { color: #86efac; }
        .fail { color: #fca5a5; }
        h2 { color: #10b981; border-bottom: 2px solid #10b981; padding-bottom: 10px; }
        iframe { width: 100%; height: 600px; border: 2px solid #10b981; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>üîç DIAGN√ìSTICO - Verificar Funciones TurnoManager</h1>
    
    <h2>üìä Resultados del Diagn√≥stico</h2>
    <pre id="results"></pre>
    
    <h2>üìã C√≥digo Cargado</h2>
    <iframe id="appFrame" src="http://localhost:8000/nuevo_cuadrante_mejorado.html"></iframe>

    <script>
        // Esperar a que iframe cargue
        const iframe = document.getElementById('appFrame');
        const resultsDiv = document.getElementById('results');
        
        setTimeout(() => {
            try {
                const iframeWindow = iframe.contentWindow;
                const TurnoManager = iframeWindow.TurnoManager;
                
                let diagnostico = 'üìã DIAGN√ìSTICO DE FUNCIONES\n';
                diagnostico += '‚îÄ'.repeat(50) + '\n\n';
                
                if (!TurnoManager) {
                    diagnostico += '<span class="fail">‚ùå ERROR: TurnoManager no existe en iframe</span>\n';
                } else {
                    diagnostico += '<span class="pass">‚úÖ TurnoManager encontrado</span>\n\n';
                    
                    const funciones = [
                        'inicializarDatos',
                        'reiniciarDatos',
                        'generarTurnosEmpleado',
                        'esCuadranteVacio',
                        'mostrarModalGeneracion',
                        'cerrarModalGeneracion',
                        'generarTurnos',
                        'verificarYMostrarBoton',
                        'cargarTurnosPorDefecto'
                    ];
                    
                    diagnostico += 'üìå VERIFICACI√ìN DE FUNCIONES:\n';
                    diagnostico += '‚îÄ'.repeat(50) + '\n';
                    
                    funciones.forEach(fn => {
                        const existe = typeof TurnoManager[fn] === 'function';
                        const icon = existe ? '‚úÖ' : '‚ùå';
                        const color = existe ? 'pass' : 'fail';
                        diagnostico += `<span class="${color}">${icon} ${fn}: ${existe ? 'EXISTE' : 'FALTA'}</span>\n`;
                    });
                    
                    diagnostico += '\n' + '‚îÄ'.repeat(50) + '\n';
                    diagnostico += '<span class="pass">TOTAL FUNCIONES: ' + funciones.filter(fn => typeof TurnoManager[fn] === 'function').length + '/' + funciones.length + '</span>\n';
                }
                
                resultsDiv.innerHTML = diagnostico;
            } catch (err) {
                resultsDiv.innerHTML = '<span class="fail">‚ùå ERROR al acceder iframe:\n' + err.message + '</span>';
            }
        }, 3000);
    </script>
</body>
</html>
