<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chat Inteligente</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .test-section { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .test-result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; border: none; border-radius: 5px; }
        .test-btn { background: #007bff; color: white; }
        .test-btn:hover { background: #0056b3; }
        .chat-demo { border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #f9f9f9; }
        .user-msg { text-align: right; margin: 10px 0; }
        .bot-msg { text-align: left; margin: 10px 0; }
        .msg-bubble { display: inline-block; padding: 8px 12px; border-radius: 15px; max-width: 70%; }
        .user-bubble { background: #007bff; color: white; }
        .bot-bubble { background: white; color: #333; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Test: Chat Inteligente</h1>

    <div class="test-section">
        <h2>Pruebas AutomÃ¡ticas</h2>
        <div id="autoTests"></div>
        <button class="test-btn" onclick="runAutoTests()">Ejecutar Pruebas AutomÃ¡ticas</button>
    </div>

    <div class="test-section">
        <h2>Demo Interactivo del Chat</h2>
        <div class="chat-demo" id="chatDemo">
            <div style="text-align: center; color: #666; font-style: italic;">
                Haz clic en los botones para probar preguntas comunes
            </div>
        </div>
        <div style="margin-top: 15px;">
            <button class="test-btn" onclick="testPregunta('Â¿CuÃ¡ntos empleados hay?')">Â¿CuÃ¡ntos empleados hay?</button>
            <button class="test-btn" onclick="testPregunta('Â¿Empleados por departamento?')">Â¿Empleados por departamento?</button>
            <button class="test-btn" onclick="testPregunta('Â¿InformaciÃ³n de MarÃ­a RodrÃ­guez?')">Â¿InformaciÃ³n de MarÃ­a?</button>
            <button class="test-btn" onclick="testPregunta('Â¿EstadÃ­sticas del mes?')">Â¿EstadÃ­sticas del mes?</button>
            <button class="test-btn" onclick="testPregunta('ayuda')">Ayuda</button>
        </div>
    </div>

    <div class="test-section">
        <h2>Prueba Manual</h2>
        <input type="text" id="manualInput" placeholder="Escribe tu pregunta aquÃ­..." style="width: 70%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
        <button class="test-btn" onclick="testPreguntaManual()">Probar</button>
    </div>

    <script src="js/modules.js"></script>
    <script>
        function addResult(message, success = true) {
            const container = document.getElementById('autoTests');
            const div = document.createElement('div');
            div.className = `test-result ${success ? 'success' : 'error'}`;
            div.textContent = message;
            container.appendChild(div);
        }

        function runAutoTests() {
            document.getElementById('autoTests').innerHTML = '';

            // Test 1: Verificar que la clase ChatBot existe
            if (typeof ChatBot !== 'undefined') {
                addResult('âœ“ Clase ChatBot cargada correctamente');
            } else {
                addResult('âœ— Clase ChatBot no encontrada', false);
                return;
            }

            // Test 2: Verificar mÃ©todo procesarPregunta
            if (typeof ChatBot.procesarPregunta === 'function') {
                addResult('âœ“ MÃ©todo procesarPregunta disponible');
            } else {
                addResult('âœ— MÃ©todo procesarPregunta no encontrado', false);
            }

            // Test 3: Probar pregunta simple
            const respuesta1 = ChatBot.procesarPregunta('Â¿CuÃ¡ntos empleados hay?');
            if (respuesta1 && respuesta1.includes('empleados')) {
                addResult('âœ“ Procesamiento de pregunta bÃ¡sica funciona');
            } else {
                addResult('âœ— Error en procesamiento de pregunta bÃ¡sica', false);
            }

            // Test 4: Probar extracciÃ³n de nombre
            const nombreExtraido = ChatBot.extraerNombre('Â¿InformaciÃ³n de MarÃ­a RodrÃ­guez?');
            if (nombreExtraido === 'MarÃ­a RodrÃ­guez LÃ³pez') {
                addResult('âœ“ ExtracciÃ³n de nombres funciona');
            } else {
                addResult(`âœ— Error en extracciÃ³n de nombres: ${nombreExtraido}`, false);
            }

            // Test 5: Probar pregunta de ayuda
            const respuestaAyuda = ChatBot.procesarPregunta('ayuda');
            if (respuestaAyuda && respuestaAyuda.includes('Preguntas que puedes hacer')) {
                addResult('âœ“ Comando de ayuda funciona');
            } else {
                addResult('âœ— Error en comando de ayuda', false);
            }

            addResult('Pruebas completadas');
        }

        function testPregunta(pregunta) {
            const respuesta = ChatBot.procesarPregunta(pregunta);
            agregarMensajeChat(pregunta, respuesta, true);
        }

        function testPreguntaManual() {
            const input = document.getElementById('manualInput');
            const pregunta = input.value.trim();
            if (pregunta) {
                const respuesta = ChatBot.procesarPregunta(pregunta);
                agregarMensajeChat(pregunta, respuesta, true);
                input.value = '';
            }
        }

        function agregarMensajeChat(pregunta, respuesta, esDemo = false) {
            const container = esDemo ? document.getElementById('chatDemo') : document.getElementById('autoTests');

            // Limpiar container si es demo
            if (esDemo) {
                container.innerHTML = '';
            }

            // Mensaje del usuario
            const userDiv = document.createElement('div');
            userDiv.className = 'user-msg';
            userDiv.innerHTML = `<div class="msg-bubble user-bubble">${pregunta}</div>`;
            container.appendChild(userDiv);

            // Mensaje del bot
            const botDiv = document.createElement('div');
            botDiv.className = 'bot-msg';
            botDiv.innerHTML = `<div class="msg-bubble bot-bubble">${respuesta.replace(/\n/g, '<br>')}</div>`;
            container.appendChild(botDiv);
        }

        // Ejecutar pruebas automÃ¡ticamente al cargar
        window.addEventListener('load', () => {
            setTimeout(runAutoTests, 500);
        });
    </script>
</body>
</html>