<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Test Bot√≥n A+B</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f5f5f5; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .console-box { background: #1e1e1e; color: #00ff00; padding: 15px; border-radius: 5px; font-family: monospace; max-height: 400px; overflow-y: auto; margin-top: 20px; }
        .console-line { margin: 5px 0; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Test del Sistema Modal A+B</h1>
        
        <h2>Pruebas:</h2>
        <button onclick="test1()">1Ô∏è‚É£ Limpiar localStorage</button>
        <button onclick="test2()">2Ô∏è‚É£ Recargar p√°gina</button>
        <button onclick="test3()">3Ô∏è‚É£ Verificar bot√≥n</button>
        <button onclick="test4()">4Ô∏è‚É£ Verificar cuadrante vac√≠o</button>
        <button onclick="test5()">5Ô∏è‚É£ Verificar modal</button>
        <button onclick="test6()">6Ô∏è‚É£ Simular clic en bot√≥n</button>
        
        <div id="results"></div>
        <div class="console-box" id="console"></div>
    </div>

    <script>
        const resultsDiv = document.getElementById('results');
        const consoleDiv = document.getElementById('console');
        let testLog = [];

        function log(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            testLog.push(`[${timestamp}] ${message}`);
            
            const line = document.createElement('div');
            line.className = 'console-line';
            line.textContent = `[${timestamp}] ${message}`;
            if (type === 'error') line.style.color = '#ff6b6b';
            if (type === 'warn') line.style.color = '#ffa94d';
            if (type === 'success') line.style.color = '#51cf66';
            
            consoleDiv.appendChild(line);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        function addResult(title, message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>${title}</strong><br>${message}`;
            resultsDiv.appendChild(div);
            log(`${title}: ${message}`, type);
        }

        function test1() {
            log('=== TEST 1: Limpiar localStorage ===');
            try {
                localStorage.clear();
                log('‚úÖ localStorage limpiado');
                addResult('‚úÖ localStorage', 'Se eliminaron todos los datos guardados', 'success');
            } catch (e) {
                log('‚ùå Error:', e.message);
                addResult('‚ùå localStorage', e.message, 'error');
            }
        }

        function test2() {
            log('=== TEST 2: Recargar p√°gina ===');
            log('‚è≥ Recargando en 2 segundos...');
            addResult('‚è≥ Recarga', 'La p√°gina se recargar√° en 2 segundos para aplicar los cambios', 'info');
            setTimeout(() => location.reload(), 2000);
        }

        function test3() {
            log('=== TEST 3: Verificar bot√≥n ===');
            
            // Cargar archivo HTML principal
            fetch('nuevo_cuadrante_mejorado.html')
                .then(r => r.text())
                .then(html => {
                    if (html.includes('id="btnGenerarTurnos"')) {
                        log('‚úÖ Bot√≥n encontrado en HTML');
                        const match = html.match(/id="btnGenerarTurnos"[^>]*>/);
                        if (match) {
                            log(`Atributos: ${match[0]}`);
                            addResult('‚úÖ Bot√≥n HTML', 'Bot√≥n btnGenerarTurnos existe', 'success');
                        }
                    } else {
                        log('‚ùå Bot√≥n NO encontrado en HTML');
                        addResult('‚ùå Bot√≥n HTML', 'btnGenerarTurnos no existe', 'error');
                    }
                })
                .catch(e => {
                    log('‚ùå Error al cargar:', e.message);
                    addResult('‚ùå Fetch error', e.message, 'error');
                });
        }

        function test4() {
            log('=== TEST 4: Verificar cuadrante vac√≠o ===');
            
            // Cargar m√≥dulos
            const script = document.createElement('script');
            script.src = 'js/modules.js';
            script.onload = () => {
                log('‚úÖ modules.js cargado');
                
                if (typeof TurnoManager !== 'undefined') {
                    log('‚úÖ TurnoManager disponible');
                    
                    if (typeof TurnoManager.esCuadranteVacio === 'function') {
                        const vacio = TurnoManager.esCuadranteVacio();
                        log(`esCuadranteVacio(): ${vacio}`);
                        addResult('‚úÖ Funci√≥n', `Cuadrante vac√≠o: ${vacio}`, vacio ? 'success' : 'info');
                    } else {
                        log('‚ùå esCuadranteVacio NO es funci√≥n');
                        addResult('‚ùå Funci√≥n', 'esCuadranteVacio no existe', 'error');
                    }
                } else {
                    log('‚ùå TurnoManager NO disponible');
                    addResult('‚ùå TurnoManager', 'No se carg√≥ correctamente', 'error');
                }
            };
            script.onerror = (e) => {
                log('‚ùå Error cargando modules.js:', e);
                addResult('‚ùå Script error', e.message, 'error');
            };
            document.body.appendChild(script);
        }

        function test5() {
            log('=== TEST 5: Verificar modal ===');
            
            fetch('nuevo_cuadrante_mejorado.html')
                .then(r => r.text())
                .then(html => {
                    if (html.includes('id="modalGenerarTurnos"')) {
                        log('‚úÖ Modal encontrado en HTML');
                        addResult('‚úÖ Modal', 'modalGenerarTurnos existe', 'success');
                    } else {
                        log('‚ùå Modal NO encontrado');
                        addResult('‚ùå Modal', 'modalGenerarTurnos no existe', 'error');
                    }
                })
                .catch(e => {
                    log('‚ùå Error:', e.message);
                    addResult('‚ùå Fetch', e.message, 'error');
                });
        }

        function test6() {
            log('=== TEST 6: Simular clic ===');
            
            // Simular lo que pasar√≠a si el usuario clickea el bot√≥n
            if (typeof TurnoManager !== 'undefined' && typeof TurnoManager.mostrarModalGeneracion === 'function') {
                log('‚úÖ Funci√≥n mostrarModalGeneracion disponible');
                try {
                    TurnoManager.mostrarModalGeneracion();
                    log('‚úÖ Modal deber√≠a abrirse');
                    addResult('‚úÖ Clic simulado', 'Funci√≥n ejecutada correctamente', 'success');
                } catch (e) {
                    log('‚ùå Error ejecutando:', e.message);
                    addResult('‚ùå Error', e.message, 'error');
                }
            } else {
                log('‚ùå Funci√≥n no disponible');
                addResult('‚ùå Funci√≥n', 'mostrarModalGeneracion no est√° disponible', 'error');
            }
        }

        log('Test page loaded. Ready for testing.');
        log('Haz clic en los botones para ejecutar las pruebas.');
    </script>
</body>
</html>
